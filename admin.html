<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>New Post — Admin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Simple, dependency-free editor: contenteditable + helpers -->
  <style>
    body { max-width: 900px; margin: 2rem auto; padding: 0 1rem; font-family: ui-serif, Georgia, Garamond, serif; }
    h1 { font-size: 1.8rem; margin-bottom: .75rem; }
    .row { display: grid; gap: .75rem; grid-template-columns: 1fr 1fr; margin: 1rem 0; }
    .row > label { display: grid; gap: .35rem; }
    input[type="text"], input[type="date"], select, textarea {
      padding: .6rem .7rem; border: 1px solid #ccc; border-radius: .5rem; font-family: inherit;
    }
    #editor-toolbar button { margin-right: .35rem; }
    #editor { border: 1px solid #ccc; border-radius: .5rem; min-height: 320px; padding: 1rem; background: #fff; }
    #editor:empty::before { content: "Paste text here or start typing…"; color: #999; }
    .actions { display: flex; gap: .75rem; margin-top: 1rem; }
    .hint { color:#666; font-size: .9rem; }
    .muted { color:#777; }
    .danger { color: #a00; }
    .ok { color: #0a0; }
    .hidden { display:none; }
  </style>
</head>
<body>
  <h1>Create New Post</h1>
  <p class="hint">
    This page will commit files to your GitHub repo using the GitHub API.<br>
    <strong>Token is required</strong> (fine-grained PAT with “Contents: Read & Write”). Never hardcode it in the repo.
  </p>

  <div class="row">
    <label>Repo Owner
      <input type="text" id="owner" placeholder="e.g. not-gnu" />
    </label>
    <label>Repo Name
      <input type="text" id="repo" placeholder="e.g. not-gnu.github.io" />
    </label>
  </div>

  <div class="row">
    <label>Branch
      <input type="text" id="branch" value="main" />
    </label>
    <label>GitHub Token <span class="muted">(stored in session only)</span>
      <input type="text" id="token" placeholder="ghp_…" />
    </label>
  </div>

  <div class="row">
    <label>Post Title
      <input type="text" id="title" placeholder="september notes." />
    </label>
    <label>Author
      <input type="text" id="author" placeholder="gnu" />
    </label>
  </div>

  <div class="row">
    <label>Date
      <input type="date" id="date" />
    </label>
    <label>Category
      <input type="text" id="category" placeholder="notes / reflections / logs" />
    </label>
  </div>

  <div class="row">
    <label>Thumbnail (homepage card)
      <input type="file" id="thumb" accept="image/*" />
    </label>
    <label>Inline Images (optional, multiple)
      <input type="file" id="images" accept="image/*" multiple />
    </label>
  </div>

  <div id="editor-toolbar">
    <button type="button" data-cmd="h2">H2</button>
    <button type="button" data-cmd="h3">H3</button>
    <button type="button" data-cmd="p">Paragraph</button>
    <button type="button" data-cmd="b">Bold</button>
    <button type="button" data-cmd="i">Italic</button>
    <button type="button" id="paste-plain">Paste Plain → Format</button>
    <span class="muted">Use image picker above for uploads; we’ll insert <code>&lt;figure&gt;</code> tags automatically.</span>
  </div>

  <div id="editor" contenteditable="true"></div>

  <div class="actions">
    <button id="preview-btn">Preview HTML</button>
    <button id="publish-btn">Publish</button>
    <span id="status" class="muted"></span>
  </div>

  <template id="post-template">
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>{{TITLE}} — the gum tree</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="../style.css" rel="stylesheet">
</head>
<body>
  <a class="back-link" href="../index.html">← back to all posts</a>
  <main class="post">
    <header class="post-header">
      <h1 class="post-title">{{TITLE}}</h1>
      <p class="post-meta-line">{{AUTHOR}} • {{DATE}}</p>
      <p class="post-cat">category: {{CATEGORY}}</p>
    </header>
    <article class="post-content">
      {{CONTENT}}
    </article>
  </main>
  <script src="../script.js"></script>
</body>
</html>
  </template>

  <script src="admin.js"></script>
</body>
</html>
